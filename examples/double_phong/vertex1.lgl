tag model is vec3;
tag world is vec3;
tag camera is vec3;
tag projective is vec3;
tag hom<`t : vec3> is vec4;

declare vec4 vec4(vec3 v, float f);
declare vec3 vec3(vec4 v);

attribute model aPosition;
attribute model aNormal;
varying model vPosition;
varying model vNormal;
canon uniform hom<camera>->hom<projective> uProjection;
canon uniform hom<world>->hom<camera> uView;
canon uniform hom<model>->hom<world> uModel;

canon hom<`t> homify<`t : vec3>(`t v) { return vec4(v as vec3, 1.) as hom<`t>; }
canon `t hom_reduce<`t : vec3>(hom<`t> v) { return vec3(v as vec4) as `t; }

void main() {
  vNormal = aNormal;
  vPosition = aPosition;
  hom<projective> gl_Position = aPosition in hom<projective>;
}